# Text Semantic Similarity
REST API для нахождения семантической близости двух текстов

Для нахождения семантической близости взята библиотека [bert_score](https://github.com/Tiiiger/bert_score). В основе этого метода лежит использование векторов ембеддинга предобученных моделей на основе Transformer. В ходе вычисления сходства, ищутся попарные косинусные расстояния между ембеддингами двух текстов с последующим их осреднением.

Для написания REST API использовалась библиотека FastAPI. Для запуска сервера - Uvicorn

API предоставляет возможность запуска как непосредственно с помощью скриптов, так и посредством сбора Docker-контейнера



## Params
Параметры сервиса описаны в файле ```params.json```:

- ```model``` - какая модель используется для получения векторов ембеддингов; по умолчанию - "roberta-large"
- ```layers``` - после какого слоя брать вектора ембеддингов; по умолчанию - 17
- ```model``` - для какого языка брать предобученную модель; по умолчанию - "en"
- ```gpu``` - нужно ли использовать модель на GPU (true - использовать gpu, falce - использовать cpu); по умолчанию - falce

Если вы собираете Docker-контейнер, то параметры необходимо указать в файле непосредственно перед его сбором



## Run server
Для запуска сервера с помощью скриптов воспользуйтесь следующим набором команд
```
cd ./SemanticSimilarityAPI
pip install -r ./requirements.txt
python ./downloads_dependencies.py
uvicorn main:app --host 127.0.0.1 --port 8000
```

Если вы используете Docker, воспользуйтесь следующим набором команд
```
cd ./SemanticSimilarityAPI
docker build --no-cache -t sim-api .
docker run -t -p 8000:8080 sim-api
```

После запуска сервера API будет доступно по адресу 127.0.0.1:8000

Для остановки работы сервера воспользуйтесь сочетанием клавиш ```Ctrl+C```



## API Access
Для нахождения эмоций по тексту используйте POST-метод API: ```127.0.0.1:8000/similar-recognition```

Метод принимает на вход два параметра ```text_1``` и ```text_2```, которые пердставляют из себя два текста, схожесть между которыми нужно вычислить

То есть, чтобы сравнить схожесть между "Hello" и "Hi", передайте их в API следующим образом: ```127.0.0.1:8000/similar-recognition?text_1=Hello&text_2=Hi```

API возвращает ответ в формате json. Пример ответа представлен ниже:
```
{
  "similarity": 0.9975681900978088
}
```
Для более удобной работы с API в тестовом режиме, воспользуйтесть ```127.0.0.1:8000/docs```



## Errors
Если в ходе вычисления возникла ошибка, вместо json с близостью API вернет словарь с ошибкой, имеющий следующий вид:
```
{
  "Error": 1,
  "description": "Error during computing similarity"
}
```
